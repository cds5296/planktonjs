(function(b){function f(a,c,h){var d=a.fsutils.wrapper,b=d.data("movie");if(!b)return d=Array.prototype.slice.call(arguments),a.fsutils.startupQueue.push(d);b.setParams(h);d.data("callback",c);d.data("target",a);b=a.offset();d.css({left:b.left,top:b.top,width:a.outerWidth(),height:a.outerHeight()})}var l={elmToReplace:null,flashIsInstalled:null,defaultFlashVersion:7,replace:function(a,c,b,d,f,e,i){typeof a==="string"&&(a=document.getElementById(a));this.elmToReplace=a;this.flashIsInstalled=this.checkForFlash(e||
this.defaultFlashVersion);if(this.elmToReplace&&this.flashIsInstalled){a="<object"+(window.ActiveXObject?' id="'+b+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" data="'+c+'"':"");a+=' width="'+d+'"';a+=' height="'+f+'"';a+=">";e="<param";e+=' name="movie"';e+=' value="'+c+'"';e+=">";e+="";var j="",k="",g;for(g in i)j+='<param name="'+g+'" value="'+i[g]+'">',k+=" "+g+'="'+i[g]+'"';this.elmToReplace.innerHTML=a+e+j+('<embed id="'+b+'" src="'+c+'" type="application/x-shockwave-flash" width="'+
d+'" height="'+f+'"')+(k+"></embed>")+"</object>"}return this.elmToReplace},checkForFlash:function(a){this.flashIsInstalled=!1;var c;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a),this.flashIsInstalled=!0}catch(b){}else if(navigator.plugins&&navigator.mimeTypes.length>0&&(c=navigator.plugins["Shockwave Flash"])&&navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1")>=a)this.flashIsInstalled=!0;return this.flashIsInstalled}};b.fn.extend({fsutils:{startupQueue:[],
wrapper:null,init:function(){var a=b("*[id]",this.wrapper)[0];this.wrapper.data("movie",a);a.addEventListener("onmouseevent",function(a){var b=jQuery().fsutils.wrapper,d=b.position();a.type=="mouseout"&&b.css({top:"-100000px",left:"-100000px"});b.data("target").trigger(jQuery.Event(a.type,{pageX:d.left+a.stageX,pageY:d.top+a.stageY}))}.toString());a.addEventListener("onload",function(){var a=jQuery().fsutils.wrapper;return a.data("callback").apply(a.data("target"),arguments)}.toString());for(a.addEventListener("onsave",
function(){var a=jQuery().fsutils.wrapper;return a.data("callback").apply(a.data("target"),arguments)}.toString());this.startupQueue.length;)f.apply(this,this.startupQueue.pop())}},openFileDialog:function(a,c){this.mouseover(function(){var h=b(this);f(h,a,{dialogType:"open",cursor:h.css("cursor"),fileFilter:c.join(";")})});return b(this)},saveFileDialog:function(a){this.mouseover(function(){var c=b(this);f(c,a,{dialogType:"save",cursor:c.css("cursor")})});return b(this)}});b(document).ready(function(){jQuery().fsutils.wrapper=
b(l.replace(document.createElement("div"),["external/jquery-fsutils/fsutils.swf",Math.random()].join("?"),"fsutils-flash",900,900,9,{FlashVars:"onload=jQuery().fsutils.init",wmode:"transparent"})).css({position:"absolute","z-index":"10000000",top:"-100000px",left:"-100000px",overflow:"hidden"}).appendTo(document.body)})})(jQuery);
